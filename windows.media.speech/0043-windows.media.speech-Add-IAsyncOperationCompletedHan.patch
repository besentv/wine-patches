From 874c616a98861bf03db61f58a9d44adeb5f0d55b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Bernhard=20K=C3=B6lbl?= <besentv@gmail.com>
Date: Sat, 5 Feb 2022 14:18:35 +0100
Subject: [PATCH v2 43/45] windows.media.speech: Add
 IAsyncOperationCompletedHandler<SpeechRecognitionCompilationResult> stub.

---
 dlls/windows.media.speech/speechrecognizer.c | 105 +++++++++++++++++++
 1 file changed, 105 insertions(+)

diff --git a/dlls/windows.media.speech/speechrecognizer.c b/dlls/windows.media.speech/speechrecognizer.c
index 8ffc6743bb7..a0e386389ec 100644
--- a/dlls/windows.media.speech/speechrecognizer.c
+++ b/dlls/windows.media.speech/speechrecognizer.c
@@ -21,6 +21,111 @@
 
 WINE_DEFAULT_DEBUG_CHANNEL(speech);
 
+/*
+ *
+ * IAsyncOperationCompletedHandler<SpeechRecognitionCompilationResult>
+ *
+ */
+
+struct async_operation_completed_handler_speech_recognition_compilation_result
+{
+    IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult_iface;
+    LONG ref;
+};
+
+static inline struct async_operation_completed_handler_speech_recognition_compilation_result 
+    *impl_from_IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult(
+        IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult *iface)
+{
+    return CONTAINING_RECORD(iface, struct async_operation_completed_handler_speech_recognition_compilation_result,
+        IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult_iface);
+}
+
+static HRESULT STDMETHODCALLTYPE async_operation_completed_handler_speech_recognition_compilation_result_QueryInterface(
+    IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult *iface, REFIID iid, void **out)
+{
+    TRACE("iface %p, iid %s, out %p.\n", iface, debugstr_guid(iid), out);
+
+    if (IsEqualGUID(iid, &IID_IUnknown) ||
+        IsEqualGUID(iid, &IID_IInspectable) ||
+        IsEqualGUID(iid, &IID_IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult))
+    {
+        IUnknown_AddRef(iface);
+        *out = iface;
+        return S_OK;
+    }
+
+    WARN("%s not implemented, returning E_NOINTERFACE.\n", debugstr_guid(iid));
+    *out = NULL;
+    return E_NOINTERFACE;
+}
+
+static ULONG STDMETHODCALLTYPE async_operation_completed_handler_speech_recognition_compilation_result_AddRef(
+    IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult *iface)
+{
+    struct async_operation_completed_handler_speech_recognition_compilation_result *impl =
+        impl_from_IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult(iface);
+
+    ULONG ref = InterlockedIncrement(&impl->ref);
+    TRACE("iface %p, ref %u.\n", iface, ref);
+
+    return ref;
+}
+
+static ULONG STDMETHODCALLTYPE async_operation_completed_handler_speech_recognition_compilation_result_Release(
+    IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult *iface)
+{
+    struct async_operation_completed_handler_speech_recognition_compilation_result *impl =
+        impl_from_IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult(iface);
+
+    ULONG ref = InterlockedDecrement(&impl->ref);
+    TRACE("iface %p, ref %u.\n", iface, ref);
+
+    if(!ref)
+        free(impl);
+
+    return ref;
+}
+
+static HRESULT STDMETHODCALLTYPE async_operation_completed_handler_speech_recognition_compilation_result_Invoke(
+    IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult *iface,
+    IAsyncOperation_SpeechRecognitionCompilationResult *info,
+    AsyncStatus status)
+{
+    FIXME("iface %p, info %p, status %u stub!\n", iface, info, status);
+    return E_NOTIMPL;
+}
+
+static const struct IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResultVtbl
+    async_operation_completed_handler_speech_recognition_compilation_result_vtbl =
+{
+    /* IUnknown methods */
+    async_operation_completed_handler_speech_recognition_compilation_result_QueryInterface,
+    async_operation_completed_handler_speech_recognition_compilation_result_AddRef,
+    async_operation_completed_handler_speech_recognition_compilation_result_Release,
+    /* IAsyncOperationCompletedHandler<SpeechRecognitionCompilationResult> methods */
+    async_operation_completed_handler_speech_recognition_compilation_result_Invoke,
+};
+
+static HRESULT async_operation_completed_handler_speech_recognition_compilation_result_create(
+    IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult **out)
+{
+    struct async_operation_completed_handler_speech_recognition_compilation_result *impl;
+
+    if (!(impl = calloc(1, sizeof(*impl))))
+    {
+        *out = NULL;
+        return E_OUTOFMEMORY;
+    }
+
+    impl->IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult_iface.lpVtbl =
+        &async_operation_completed_handler_speech_recognition_compilation_result_vtbl;
+    impl->ref = 1;
+
+    *out = &impl->IAsyncOperationCompletedHandler_SpeechRecognitionCompilationResult_iface;
+    return S_OK;
+}
+
 /*
  *
  * IAsyncOperation<SpeechRecognitionCompilationResult>
-- 
2.34.1

