From 592d0fce39daa3f20f2bbcdbdbefb422e83fd79a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Bernhard=20K=C3=B6lbl?= <besentv@gmail.com>
Date: Sat, 5 Feb 2022 00:05:03 +0100
Subject: [PATCH v2 35/52] windows.media.speech: Implement
 IVector<ISpeechRecgonitionListConstraint> Clear.

---
 dlls/windows.media.speech/speechrecognizer.c | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

diff --git a/dlls/windows.media.speech/speechrecognizer.c b/dlls/windows.media.speech/speechrecognizer.c
index 77858e9cc42..01c0ab93b71 100644
--- a/dlls/windows.media.speech/speechrecognizer.c
+++ b/dlls/windows.media.speech/speechrecognizer.c
@@ -186,8 +186,15 @@ static HRESULT STDMETHODCALLTYPE vector_speech_recgonition_constraint_RemoveAtEn
 static HRESULT STDMETHODCALLTYPE vector_speech_recgonition_constraint_Clear(
     IVector_ISpeechRecognitionConstraint *iface)
 {
-    FIXME("iface %p, stub!\n", iface);
-    return E_NOTIMPL;
+    struct vector_speech_recgonition_constraint *impl = impl_from_IVector_ISpeechRecognitionConstraint(iface);
+    TRACE("iface %p.\n", iface);
+
+    impl->count = 0;
+    if(impl->values)
+        free(impl->values);
+    impl->values = NULL;
+
+    return S_OK;
 }
 
 static HRESULT STDMETHODCALLTYPE vector_speech_recgonition_constraint_GetMany(
-- 
2.35.1

