From b0128d8e3576df16c99a741707fd5576f0c8e6e9 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Bernhard=20K=C3=B6lbl?= <besentv@gmail.com>
Date: Sun, 30 Jan 2022 20:42:50 +0100
Subject: [PATCH v2 08/52] include/windows.media.speechrecognition.idl: Add
 SpeechRecognitionQualityDegradingEventArgs.

And a needed enum.
---
 include/windows.media.speechrecognition.idl | 34 +++++++++++++++++++++
 1 file changed, 34 insertions(+)

diff --git a/include/windows.media.speechrecognition.idl b/include/windows.media.speechrecognition.idl
index 7d323d84b3a..75a060d38d1 100644
--- a/include/windows.media.speechrecognition.idl
+++ b/include/windows.media.speechrecognition.idl
@@ -33,6 +33,7 @@ namespace Windows {
     namespace Media {
         namespace SpeechRecognition {
             typedef enum SpeechContinuousRecognitionMode SpeechContinuousRecognitionMode;
+            typedef enum SpeechRecognitionAudioProblem SpeechRecognitionAudioProblem;
             typedef enum SpeechRecognitionConfidence SpeechRecognitionConfidence;
             typedef enum SpeechRecognitionConstraintProbability SpeechRecognitionConstraintProbability;
             typedef enum SpeechRecognitionConstraintType SpeechRecognitionConstraintType;
@@ -44,6 +45,7 @@ namespace Windows {
             interface ISpeechRecognitionConstraint;
             interface ISpeechRecognitionHypothesis;
             interface ISpeechRecognitionHypothesisGeneratedEventArgs;
+            interface ISpeechRecognitionQualityDegradingEventArgs;
             interface ISpeechRecognitionResult;
             interface ISpeechRecognitionResult2;
             interface ISpeechRecognitionSemanticInterpretation;
@@ -55,6 +57,7 @@ namespace Windows {
             runtimeclass SpeechRecognitionCompilationResult;
             runtimeclass SpeechRecognitionHypothesis;
             runtimeclass SpeechRecognitionHypothesisGeneratedEventArgs;
+            runtimeclass SpeechRecognitionQualityDegradingEventArgs;
             runtimeclass SpeechRecognitionResult;
             runtimeclass SpeechRecognitionSemanticInterpretation;
             runtimeclass SpeechRecognizerTimeouts;
@@ -88,6 +91,18 @@ namespace Windows {
                 PauseOnRecognition = 1
             };
 
+            [contract(Windows.Foundation.UniversalApiContract, 1.0)]
+            enum SpeechRecognitionAudioProblem
+            {
+                None = 0,
+                TooNoisy = 1,
+                NoSignal = 2,
+                TooLoud = 3,
+                TooQuiet = 4,
+                TooFast = 5,
+                TooSlow = 6,
+            };
+
             [contract(Windows.Foundation.UniversalApiContract, 1.0)]
             enum SpeechRecognitionConfidence
             {
@@ -220,6 +235,16 @@ namespace Windows {
                 [propget] HRESULT Hypothesis([out, retval] Windows.Media.SpeechRecognition.SpeechRecognitionHypothesis **value);
             }
 
+            [
+                contract(Windows.Foundation.UniversalApiContract, 1.0),
+                exclusiveto(Windows.Media.SpeechRecognition.SpeechRecognitionQualityDegradingEventArgs),
+                uuid(4fe24105-8c3a-4c7e-8d0a-5bd4f5b14ad8)
+            ]
+            interface ISpeechRecognitionQualityDegradingEventArgs : IInspectable
+            {
+                [propget] HRESULT Problem([out, retval] Windows.Media.SpeechRecognition.SpeechRecognitionAudioProblem **value);
+            }
+
             [
                 contract(Windows.Foundation.UniversalApiContract, 1.0),
                 exclusiveto(Windows.Media.SpeechRecognition.SpeechRecognitionResult),
@@ -349,6 +374,15 @@ namespace Windows {
                 [default] interface Windows.Media.SpeechRecognition.ISpeechRecognitionHypothesisGeneratedEventArgs;
             }
 
+            [
+                contract(Windows.Foundation.UniversalApiContract, 1.0),
+                marshaling_behavior(agile)
+            ]
+            runtimeclass SpeechRecognitionQualityDegradingEventArgs
+            {
+                [default] interface Windows.Media.SpeechRecognition.ISpeechRecognitionQualityDegradingEventArgs;
+            }
+
             [
                 contract(Windows.Foundation.UniversalApiContract, 1.0),
                 marshaling_behavior(agile)
-- 
2.35.1

